(this.webpackJsonpphotoviewer=this.webpackJsonpphotoviewer||[]).push([[0],{29:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var c=n(1),i=n(0),a=n(12),o=n.n(a),s=(n(29),n(3)),r=n(8),l=Object(i.createContext)(void 0);var j=function(e){return Object(c.jsx)("div",{className:"header",children:Object(c.jsxs)("h2",{children:[e.albumDetails&&e.albumDetails.title?Object(c.jsx)(r.b,{to:"/",children:"Albums"}):"Albums",e.albumDetails&&e.albumDetails.title&&Object(c.jsxs)("span",{children:["\xa0\xbb\xa0",e.albumDetails.title]})]})})};var u=function(){var e=Object(i.useContext)(l),t=Object(i.useState)([]),n=Object(s.a)(t,2),a=n[0],o=n[1],u=Object(i.useState)(!0),b=Object(s.a)(u,2),d=b[0],h=b[1];Object(i.useEffect)((function(){e.loadAlbums().then((function(e){o(e),h(!1)}))}),[e]);var O=a.map((function(e){return Object(c.jsxs)("li",{children:[Object(c.jsx)(r.b,{to:"/album/"+e.id,children:Object(c.jsxs)("figure",{children:[Object(c.jsx)("img",{src:e.coverPhotoBaseUrl,alt:""}),Object(c.jsx)("figcaption",{children:Object(c.jsx)("h3",{children:e.title})})]})}),Object(c.jsx)("br",{})]},e.id)}));return Object(c.jsxs)("div",{children:[d&&"Loading...",a.length>0&&Object(c.jsxs)("div",{children:[Object(c.jsx)(j,{}),Object(c.jsx)("ul",{className:"albums",children:O})]}),Object(c.jsx)("hr",{}),Object(c.jsx)(r.b,{to:"/",children:"Back to Albums List"})]})},b=n(23);var d=function(e){var t=e.photoID,n=e.photoNumber,a=e.photosTotal;console.log("ViewPhoto -",t,n,a);var o=Object(i.useContext)(l),r=Object(i.useState)(void 0),j=Object(s.a)(r,2),u=j[0],b=j[1],d=Object(i.useState)(!0),h=Object(s.a)(d,2),O=h[0],f=h[1];return Object(i.useEffect)((function(){o.loadPhotoDetail(t).then((function(e){b(e),f(!1)}))}),[e.match,o,t]),Object(c.jsxs)("div",{children:[O&&Object(c.jsx)("figure",{children:Object(c.jsx)("figcaption",{children:"'Loading...'"})}),!O&&u&&Object(c.jsxs)("figure",{children:[Object(c.jsx)("img",{src:u.baseUrl,alt:""}),Object(c.jsxs)("figcaption",{children:[n," of ",a]})]}),!O&&!u&&Object(c.jsx)("figure",{children:Object(c.jsx)("figcaption",{children:"Photo not found"})})]})},h=document.getElementById("root");var O=function(e){var t=document.createElement("div");return t.setAttribute("id","modal"),Object(i.useEffect)((function(){return h.appendChild(t),function(){h.removeChild(t)}})),o.a.createPortal(e.children,t)};var f=function(e){return Object(c.jsx)(O,{children:Object(c.jsx)("div",{className:"wrapper",onClick:function(t){e.handleClose(t)},children:Object(c.jsx)("div",{className:"inner",children:e.children})})})};var p=function(e){var t=e.match.params.aid,n=Object(i.useContext)(l),a=Object(i.useState)(void 0),o=Object(s.a)(a,2),u=o[0],h=o[1],O=Object(i.useState)(!0),p=Object(s.a)(O,2),v=p[0],m=p[1],x=Object(i.useState)(!1),g=Object(s.a)(x,2),S=g[0],I=g[1],C=Object(i.useState)(void 0),w=Object(s.a)(C,2),D=w[0],k=w[1],A=Object(i.useState)(void 0),P=Object(s.a)(A,2),E=P[0],y=P[1],T=Object(i.useState)(1),_=Object(s.a)(T,2),N=_[0],B=_[1],L=Object(i.useState)(void 0),R=Object(s.a)(L,2),U=R[0],W=R[1],G=Object(i.useState)([void 0]),H=Object(s.a)(G,2),K=H[0],F=H[1],J=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;e.preventDefault();var c=e.target.className;S?"inner"!==c&&"wrapper"!==c||I(!1):(k(t),y(parseInt(n)+1),I(!0))};return Object(i.useEffect)((function(){n.loadAlbumDetail(t,U).then((function(e){h(e),m(!1)}))}),[e.match,n,t,U]),Object(c.jsxs)("div",{children:[v&&Object(c.jsx)("span",{children:"'Loading...'"}),!v&&u&&Object(c.jsxs)("div",{children:[Object(c.jsx)(j,{albumDetails:u}),Object(c.jsx)("ul",{children:u.result.mediaItems.map((function(e,t){return Object(c.jsx)("li",{children:Object(c.jsx)("a",{href:"#",onClick:function(n){J(n,e.id,t)},children:Object(c.jsx)("figure",{children:Object(c.jsx)("img",{src:e.baseUrl,alt:""})})})},e.id)}))}),S&&Object(c.jsx)(f,{handleClose:J,shown:S,children:Object(c.jsx)(d,{photoID:D,photoNumber:E,photosTotal:u.mediaItemsCount})}),Object(c.jsxs)("div",{id:"pagination",children:[U&&Object(c.jsxs)("span",{children:[Object(c.jsx)("a",{href:"#",onClick:function(e){!function(e){e.preventDefault(),W(K[N-1]),B(N-1)}(e)},children:"Prev"}),"\xa0"]}),Object(c.jsxs)("span",{children:[N," of"," ",Math.ceil(u.mediaItemsCount/25)]}),u.result.nextPageToken&&Object(c.jsxs)("span",{children:["\xa0",Object(c.jsx)("a",{href:"#",onClick:function(e){!function(e){e.preventDefault(),"undefined"===typeof K[N]&&F([].concat(Object(b.a)(K),[U])),W(u.result.nextPageToken),B(N+1)}(e)},children:"Next"})]})]})]}),!v&&!u&&Object(c.jsx)("span",{children:"Album not found"}),Object(c.jsx)("hr",{}),Object(c.jsx)(r.b,{to:"/",children:"Back to Albums List"})]})};var v=function(){return Object(c.jsxs)("div",{children:["This site was made with React 16.8, Google Photos API, and SASS.",Object(c.jsx)("br",{}),Object(c.jsx)(r.b,{to:"/",children:"Back"})]})},m=n(2),x=n(18),g=n(21),S=n(22),I=function(){function e(t){Object(g.a)(this,e),this.gapiClient=t}return Object(S.a)(e,[{key:"loadAlbums",value:function(){return this.gapiClient.photoslibrary.albums.list({}).then((function(e){return e.result.albums}))}},{key:"loadAlbumDetail",value:function(e,t){var n=this;return this.gapiClient.photoslibrary.albums.get({albumId:e}).then((function(e){return e.result})).then((function(c){return n.gapiClient.photoslibrary.mediaItems.search({albumId:e,pageToken:t}).then((function(e){return Object(x.a)(Object(x.a)({},c),{},{result:e.result})}))})).catch((function(e){}))}},{key:"loadPhotoDetail",value:function(e){return this.gapiClient.photoslibrary.mediaItems.get({mediaItemId:e}).then((function(e){return e.result})).catch((function(e){}))}}]),e}(),C="https://www.googleapis.com/auth/photoslibrary.readonly";var w=function(e){var t=Object(i.useState)(!0),n=Object(s.a)(t,2),a=n[0],o=n[1],j=Object(i.useState)(!1),b=Object(s.a)(j,2),d=b[0],h=b[1],O=Object(i.useState)(void 0),f=Object(s.a)(O,2),x=f[0],g=f[1];Object(i.useEffect)((function(){console.log("we've mounted");var t=setInterval((function(){window.gapi&&(clearInterval(t),gapi.load("client:auth2",(function(){gapi.client.init({discoveryDocs:["https://photoslibrary.googleapis.com/$discovery/rest?version=v1"],clientId:e.gapiID,scope:C}).then((function(){o(!1);var e=gapi.auth2.getAuthInstance();e.isSignedIn.listen((function(){h(t.hasGrantedScopes(C))}));var t=e.currentUser.get(),n=t.hasGrantedScopes(C);g(new I(gapi.client)),h(n)}))})))}),100)}),[e.gapiID]);var S=Object(i.useCallback)((function(){gapi.auth2.getAuthInstance().signOut()}),[]),w=Object(i.useCallback)((function(){gapi.auth2.getAuthInstance().signIn()}),[]);return a?Object(c.jsx)("div",{children:"Initialising..."}):d?Object(c.jsx)("div",{className:"App",children:Object(c.jsx)(l.Provider,{value:x,children:Object(c.jsxs)(r.a,{children:[Object(c.jsx)("button",{onClick:S,children:"Sign Out"}),Object(c.jsx)(m.a,{path:"/",exact:!0,component:u}),Object(c.jsx)(m.a,{path:"/album/:aid",component:p}),Object(c.jsx)(m.a,{path:"/about",component:v})]})})}):Object(c.jsx)("button",{onClick:w,children:"Sign in"})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(c.jsx)(w,{gapiID:Object({NODE_ENV:"production",PUBLIC_URL:"/google-photos-viewer",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_GAPI_CLIENT_ID}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[35,1,2]]]);
//# sourceMappingURL=main.7f48eb0e.chunk.js.map